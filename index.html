<!DOCTYPE html>
<html lang="en" class="dark"> <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PhishGuard Labs | AI Scam Detector</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/html5-qrcode"></script>
    
    <script>
        // Tailwind configuration for manual dark mode
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        brand: '#3b82f6',
                    }
                }
            }
        }
    </script>
    
    <style>
        /* Smooth transition for theme switching */
        .transition-theme { transition: background-color 0.5s ease, color 0.5s ease; }
        
        /* Pulse animation for the scan button */
        @keyframes pulse-blue {
            0% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(59, 130, 246, 0); }
            100% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0); }
        }
        .scanning-pulse { animation: pulse-blue 1.5s infinite; }
        
        /* QR Scanner Container Styling */
        #qr-reader { border: none !important; }
        #qr-reader img { display: none !important; }
    </style>
</head>
<body class="transition-theme bg-slate-50 dark:bg-slate-950 text-slate-900 dark:text-slate-100 min-h-screen font-sans">

    <nav class="p-6 flex justify-between items-center max-w-5xl mx-auto">
        <div class="flex items-center gap-3">
            <img src="logo.jpg" alt="PhishGuard Logo" class="h-10 w-auto rounded-lg shadow-lg">
            <h1 class="text-2xl font-black tracking-tighter text-blue-600 dark:text-blue-400">PHISHGUARD <span class="text-slate-400">LABS</span></h1>
        </div>
        
        <button id="themeToggle" class="p-2 rounded-full bg-slate-200 dark:bg-slate-800 hover:scale-110 transition-transform">
            <span class="dark:hidden">üåô Dark</span>
            <span class="hidden dark:inline">‚òÄÔ∏è Light</span>
        </button>
    </nav>

    <main class="max-w-3xl mx-auto p-6 mt-10">
        <div class="text-center mb-12">
            <h2 class="text-4xl font-extrabold mb-4 leading-tight">Identify Scams Before They Strike.</h2>
            <p class="text-slate-500 dark:text-slate-400">Analyze suspicious links, SMS, or QR codes using Gemini 3 Intelligence.</p>
        </div>

        <div class="bg-white dark:bg-slate-900 p-8 rounded-3xl shadow-2xl border border-slate-200 dark:border-slate-800 transition-all hover:shadow-blue-500/10">
            
            <div class="flex gap-4 mb-6">
                <button onclick="switchTab('text')" id="tabText" class="px-4 py-2 rounded-lg font-bold bg-blue-600 text-white">Text / Link</button>
                <button onclick="switchTab('qr')" id="tabQR" class="px-4 py-2 rounded-lg font-bold bg-slate-200 dark:bg-slate-800 text-slate-600 dark:text-slate-400">Scan QR Code</button>
            </div>

            <div id="textInputArea">
                <textarea id="userInput" placeholder="Paste the suspicious link or message here..." 
                    class="w-full h-40 p-5 rounded-2xl bg-slate-50 dark:bg-slate-800 border-none focus:ring-2 focus:ring-blue-500 outline-none text-lg resize-none mb-6"></textarea>
            </div>

            <div id="qrInputArea" class="hidden text-center">
                <div id="qr-reader" class="w-full rounded-2xl overflow-hidden mb-4"></div>
                <p class="text-sm text-slate-400 mb-4">Point your camera at a QR code to extract its link.</p>
            </div>

            <button id="scanBtn" onclick="analyzeContent()" 
                class="w-full py-4 bg-blue-600 hover:bg-blue-700 text-white font-black text-xl rounded-2xl transition-all active:scale-95 flex justify-center items-center gap-2">
                <span id="btnText">ANALYZE NOW</span>
            </button>
            
            <div class="flex justify-center gap-6 mt-6 opacity-40 text-[10px] font-bold uppercase tracking-widest">
                <span>üõ°Ô∏è AES-256 Secure</span>
                <span>ü§ñ Gemini 3 AI</span>
                <span>‚òÅÔ∏è Google Cloud</span>
            </div>
        </div>

        <div id="resultArea" class="mt-8 hidden p-8 rounded-3xl border-2 transition-all">
            <div id="riskBadge" class="inline-block px-4 py-1 rounded-full text-xs font-black uppercase mb-4 tracking-tighter"></div>
            <h3 id="riskLevel" class="text-2xl font-black mb-2"></h3>
            <div id="explanation" class="text-lg leading-relaxed space-y-2"></div>
        </div>
    </main>

    <script type="module">
        import { GoogleGenerativeAI } from "https://esm.run/@google/generative-ai";

        // CONFIGURATION - Update with your new API Key
        const API_KEY = "PASTE_YOUR_NEW_API_KEY_HERE";
        const genAI = new GoogleGenerativeAI(API_KEY);

        // TAB SYSTEM
        window.switchTab = (type) => {
            const textTab = document.getElementById('textInputArea');
            const qrTab = document.getElementById('qrInputArea');
            const btnText = document.getElementById('tabText');
            const btnQR = document.getElementById('tabQR');

            if(type === 'text') {
                textTab.classList.remove('hidden');
                qrTab.classList.add('hidden');
                btnText.className = "px-4 py-2 rounded-lg font-bold bg-blue-600 text-white";
                btnQR.className = "px-4 py-2 rounded-lg font-bold bg-slate-200 dark:bg-slate-800 text-slate-600 dark:text-slate-400";
                stopQR();
            } else {
                textTab.classList.add('hidden');
                qrTab.classList.remove('hidden');
                btnQR.className = "px-4 py-2 rounded-lg font-bold bg-blue-600 text-white";
                btnText.className = "px-4 py-2 rounded-lg font-bold bg-slate-200 dark:bg-slate-800 text-slate-600 dark:text-slate-400";
                startQR();
            }
        };

        // QR SCANNER LOGIC
        let html5QrcodeScanner;
        function startQR() {
            html5QrcodeScanner = new Html5QrcodeScanner("qr-reader", { fps: 10, qrbox: 250 });
            html5QrcodeScanner.render((decodedText) => {
                document.getElementById('userInput').value = decodedText;
                switchTab('text'); // Switch back to text to show the link
            });
        }
        function stopQR() { if(html5QrcodeScanner) html5QrcodeScanner.clear(); }

        // THEME TOGGLE
        document.getElementById('themeToggle').addEventListener('click', () => {
            document.documentElement.classList.toggle('dark');
        });

        // ANALYSIS LOGIC
        window.analyzeContent = async () => {
            const input = document.getElementById('userInput').value;
            const btn = document.getElementById('scanBtn');
            const resultArea = document.getElementById('resultArea');
            
            if(!input) return alert("Please paste something first!");

            btn.classList.add('scanning-pulse');
            btn.innerText = "THINKING...";

            try {
                // Using stable model to avoid 404 errors during demo
                const model = genAI.getGenerativeModel({ model: "gemini-1.5-flash" });
                
                const prompt = `Analyze this message/link for phishing: "${input}". 
                Respond ONLY in this exact format:
                RISK: [Low/Medium/High]
                WHY: [List 3 bullet points explaining the red flags or safety]`;

                const result = await model.generateContent(prompt);
                const response = await result.response.text();
                
                displayResults(response);
            } catch (error) {
                alert("Error connecting to Gemini. Check your API Key!");
                console.error(error);
            } finally {
                btn.classList.remove('scanning-pulse');
                btn.innerText = "ANALYZE NOW";
            }
        };

        function displayResults(text) {
            const risk = text.includes("High") ? "High" : text.includes("Medium") ? "Medium" : "Low";
            const resultArea = document.getElementById('resultArea');
            const badge = document.getElementById('riskBadge');
            
            resultArea.classList.remove('hidden');
            
            if(risk === "High") {
                resultArea.className = "mt-8 p-8 rounded-3xl border-2 border-red-500 bg-red-50 dark:bg-red-900/10";
                badge.className = "inline-block px-4 py-1 rounded-full text-xs font-black bg-red-500 text-white mb-4 uppercase";
                badge.innerText = "‚ö†Ô∏è DANGER: HIGH RISK";
            } else if(risk === "Medium") {
                resultArea.className = "mt-8 p-8 rounded-3xl border-2 border-yellow-500 bg-yellow-50 dark:bg-yellow-900/10";
                badge.className = "inline-block px-4 py-1 rounded-full text-xs font-black bg-yellow-500 text-white mb-4 uppercase";
                badge.innerText = "üü† WARNING: MEDIUM RISK";
            } else {
                resultArea.className = "mt-8 p-8 rounded-3xl border-2 border-green-500 bg-green-50 dark:bg-green-900/10";
                badge.className = "inline-block px-4 py-1 rounded-full text-xs font-black bg-green-500 text-white mb-4 uppercase";
                badge.innerText = "‚úÖ SAFE: LOW RISK";
            }

            document.getElementById('riskLevel').innerText = risk + " Risk Detected";
            document.getElementById('explanation').innerText = text.split("WHY:")[1] || "No red flags detected.";
        }
    </script>
</body>
</html>
